<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Meal Prep Application Blueprint</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Neutral Harmony -->
    <!-- Application Structure Plan: The application is structured into four logical, thematic sections accessible via a sticky top navigation: Overview, Architecture, Roadmap, and Toolkit. This non-linear, dashboard-like structure was chosen to allow users—from executives to developers—to quickly jump to the information most relevant to them, rather than forcing a linear read of a dense technical document. The "Overview" provides a high-level summary. "Architecture" consolidates all system design and data schema information. "Roadmap" visualizes the project's timeline and feature rollout. "Toolkit" groups all practical setup and deployment guides. This design prioritizes user-centric navigation and information discovery over slavishly following the source report's chapter order, making the complex plan more digestible and engaging. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Executive Summary -> Goal: Inform -> Viz: Formatted Text -> Interaction: None -> Justification: Clear, direct presentation of the core strategic message. -> Library: Tailwind CSS.
        - Report Info: FastAPI vs Django -> Goal: Compare -> Viz: Side-by-side card layout & Bar Chart -> Interaction: Visual comparison -> Justification: A direct visual and textual comparison is more impactful than prose for highlighting key differences. -> Library: Chart.js for visualization, Tailwind for layout.
        - Report Info: High-Level Architecture -> Goal: Organize -> Viz: HTML/CSS Diagram -> Interaction: Hover effects on components -> Justification: A visual flow diagram simplifies the complex interaction between frontend, backend, and database. -> Library: Tailwind CSS.
        - Report Info: Modular Monolith -> Goal: Organize -> Viz: HTML/CSS Diagram -> Interaction: Click to highlight module -> Justification: Interactively demonstrates how modules are integrated, making the concept tangible. -> Library: Tailwind CSS.
        - Report Info: Phased Rollout -> Goal: Change -> Viz: Interactive Horizontal Timeline -> Interaction: Click tabs to reveal phase details -> Justification: Transforms a static list into an engaging, step-by-step exploration of the project's evolution. -> Library: Vanilla JS.
        - Report Info: Database Schema -> Goal: Organize -> Viz: Accordion List -> Interaction: Click to expand/collapse tables -> Justification: Manages a large amount of detailed information, preventing visual clutter and user overwhelm. -> Library: Vanilla JS.
        - Report Info: Dev Setup & Deployment -> Goal: Inform/Organize -> Viz: Accordions, styled code blocks, tables -> Interaction: Click to expand/collapse steps -> Justification: Breaks down complex procedures into manageable, sequential steps. -> Library: Vanilla JS, Tailwind CSS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8f7f4; color: #404040; }
        .nav-link { transition: color 0.3s, border-color 0.3s; }
        .nav-link.active { color: #4338ca; border-bottom-color: #4338ca; }
        .nav-link:not(.active) { border-bottom-color: transparent; }
        .content-section { display: none; }
        .content-section.active { display: block; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-in-out, padding 0.5s ease-in-out; }
        .accordion-button.open .accordion-arrow { transform: rotate(180deg); }
        .accordion-arrow { transition: transform 0.3s; }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 350px; max-height: 400px; }
        @media (min-width: 768px) { .chart-container { height: 400px; } }
        .timeline-btn.active { background-color: #4f46e5; color: #ffffff; }
        .timeline-btn { transition: background-color 0.3s, color 0.3s; }
        .module-diagram-item { transition: all 0.3s ease; }
        .flow-diagram-item { transition: all 0.3s ease-in-out; }
        .flow-diagram-item:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-4">
            <div class="flex items-center justify-between h-16">
                <h1 class="text-xl md:text-2xl font-bold text-gray-800">Fuel the Fire Blueprint</h1>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#overview" class="nav-link text-gray-600 hover:text-indigo-600 font-medium border-b-2 pb-1">Overview</a>
                    <a href="#architecture" class="nav-link text-gray-600 hover:text-indigo-600 font-medium border-b-2 pb-1">Architecture</a>
                    <a href="#roadmap" class="nav-link text-gray-600 hover:text-indigo-600 font-medium border-b-2 pb-1">Roadmap</a>
                    <a href="#toolkit" class="nav-link text-gray-600 hover:text-indigo-600 font-medium border-b-2 pb-1">Toolkit</a>
                </div>
                <div class="md:hidden">
                    <select id="mobile-nav" class="bg-gray-100 border border-gray-300 text-gray-700 text-sm rounded-lg focus:ring-indigo-500 focus:border-indigo-500 block w-full p-2.5">
                        <option value="overview">Overview</option>
                        <option value="architecture">Architecture</option>
                        <option value="roadmap">Roadmap</option>
                        <option value="toolkit">Toolkit</option>
                    </select>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-8">
        
        <section id="overview" class="content-section">
            <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg animate-fade-in">
                <header class="text-center mb-8">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">A Strategic Blueprint for Making Fuel the Fire Scalable</h2>
                    <p class="text-lg text-gray-600">An interactive guide to the technical architecture, development plan, and deployment strategy.</p>
                </header>
                
                <div class="bg-indigo-50 border-l-4 border-indigo-500 text-indigo-800 p-6 rounded-lg mb-8">
                    <h3 class="text-xl font-semibold mb-2">Executive Summary & Strategic Recommendation</h3>
                    <p class="text-gray-700">This document outlines a comprehensive technical blueprint for a scalable meal prep ordering service. The pivotal recommendation is to use **FastAPI** for the backend instead of Django. While Django is powerful, this project's decoupled, API-first architecture aligns perfectly with FastAPI's strengths in performance, modern design, and type safety. This choice will yield a cleaner architecture and greater long-term development velocity by matching the backend philosophy to the React frontend's Single-Page Application (SPA) nature.</p>
                </div>
                
                <h3 class="text-2xl font-bold text-center text-gray-800 mb-6">Framework Comparison: FastAPI vs. Django</h3>
                <div class="grid md:grid-cols-2 gap-8 mb-8">
                    <div class="bg-gray-50 p-6 rounded-lg border">
                        <h4 class="text-xl font-semibold text-green-700 mb-3">FastAPI (Recommended)</h4>
                        <ul class="space-y-2 text-gray-700">
                            <li class="flex items-start"><span class="text-green-500 mr-2 mt-1">✓</span><span>Superior performance with asynchronous I/O.</span></li>
                            <li class="flex items-start"><span class="text-green-500 mr-2 mt-1">✓</span><span>API-first design with automatic, interactive documentation.</span></li>
                            <li class="flex items-start"><span class="text-green-500 mr-2 mt-1">✓</span><span>Rigorous type safety via Pydantic reduces runtime bugs.</span></li>
                            <li class="flex items-start"><span class="text-green-500 mr-2 mt-1">✓</span><span>Ideal for decoupled frontends and microservices.</span></li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg border">
                        <h4 class="text-xl font-semibold text-blue-700 mb-3">Django</h4>
                        <ul class="space-y-2 text-gray-700">
                            <li class="flex items-start"><span class="text-blue-500 mr-2 mt-1">✓</span><span>"Batteries-included" for rapid monolithic development.</span></li>
                            <li class="flex items-start"><span class="text-blue-500 mr-2 mt-1">✓</span><span>Mature ecosystem with a powerful integrated ORM and admin panel.</span></li>
                            <li class="flex items-start"><span class="text-red-500 mr-2 mt-1">✗</span><span>Less performant for high-concurrency API tasks.</span></li>
                            <li class="flex items-start"><span class="text-red-500 mr-2 mt-1">✗</span><span>Templating and forms offer less value in a pure API model.</span></li>
                        </ul>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="frameworkChart"></canvas>
                </div>
                <p class="text-center text-sm text-gray-500 mt-2">Relative comparison of framework characteristics for this specific API-driven project.</p>
            </div>
        </section>

        <section id="architecture" class="content-section">
            <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                <header class="text-center mb-8">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">System Architecture</h2>
                    <p class="text-lg text-gray-600">A blueprint for a clean, decoupled, and scalable system.</p>
                </header>

                <div class="mb-12">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">1. Component Interaction Model</h3>
                    <p class="text-gray-600 mb-6">The application uses a modern Single-Page Application (SPA) model. This cleanly separates the frontend user interface from the backend business logic, creating a flexible and maintainable system. The frontend React app communicates with the backend FastAPI server via a RESTful API, and only the backend can access the database.</p>
                    <div class="bg-gray-50 rounded-xl p-6 md:p-8 border">
                        <div class="flex flex-col md:flex-row items-center justify-around space-y-8 md:space-y-0 md:space-x-4 text-center">
                            <div class="flow-diagram-item p-4 rounded-lg bg-blue-100 w-full md:w-1/4">
                                <div class="text-3xl mb-2">📱💻</div>
                                <h4 class="font-bold text-blue-800">Frontend (React)</h4>
                                <p class="text-sm text-blue-700">Runs in user's browser, handles UI.</p>
                            </div>
                            <div class="font-bold text-2xl text-gray-400 self-center">→</div>
                             <div class="flow-diagram-item p-4 rounded-lg bg-green-100 w-full md:w-1/4">
                                <div class="text-3xl mb-2">⚙️</div>
                                <h4 class="font-bold text-green-800">Backend (FastAPI)</h4>
                                <p class="text-sm text-green-700">Exposes REST API, contains business logic.</p>
                            </div>
                             <div class="font-bold text-2xl text-gray-400 self-center">→</div>
                            <div class="flow-diagram-item p-4 rounded-lg bg-purple-100 w-full md:w-1/4">
                                <div class="text-3xl mb-2">🗃️</div>
                                <h4 class="font-bold text-purple-800">Database (SQL)</h4>
                                <p class="text-sm text-purple-700">Persistence layer, accessed only by backend.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-12">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">2. The Modular Monolith</h3>
                     <p class="text-gray-600 mb-6">To balance development speed with future scalability, the backend is a "modular monolith." It's a single application, but internally it's organized into distinct, loosely-coupled business domains (Users, Orders, etc.). FastAPI's `APIRouter` is key to this, allowing each domain to be developed independently and, if needed, extracted into a separate microservice later with minimal friction.</p>
                    <div class="bg-gray-50 rounded-xl p-6 md:p-8 border flex flex-col md:flex-row items-center justify-center gap-4">
                        <div id="module-main" class="module-diagram-item bg-indigo-200 p-6 rounded-lg text-center shadow">
                            <h4 class="font-bold text-indigo-800">FastAPI App</h4>
                            <p class="text-sm text-indigo-700">(main.py)</p>
                        </div>
                        <div class="flex flex-col md:flex-row gap-4 md:items-center">
                             <div class="text-2xl font-mono text-gray-400 hidden md:block">⟭</div>
                             <div class="text-2xl font-mono text-gray-400 md:hidden text-center">⟱</div>
                            <div class="flex flex-col md:flex-row gap-2 border-2 border-dashed border-gray-300 p-4 rounded-lg">
                                <div id="module-users" class="module-diagram-item bg-sky-100 p-3 rounded text-sky-800 cursor-pointer">Users Module</div>
                                <div id="module-meals" class="module-diagram-item bg-amber-100 p-3 rounded text-amber-800 cursor-pointer">Meals Module</div>
                                <div id="module-orders" class="module-diagram-item bg-rose-100 p-3 rounded text-rose-800 cursor-pointer">Orders Module</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">3. Database Schema</h3>
                    <p class="text-gray-600 mb-6">The schema is designed for integrity and scalability, using SQLModel for a single source of truth for both database tables and API validation. Click each table name to view its columns and relationships.</p>
                    <div id="schema-accordion" class="space-y-2">
                        <!-- Accordion items will be generated here by JS -->
                    </div>
                </div>
            </div>
        </section>

        <section id="roadmap" class="content-section">
             <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                <header class="text-center mb-8">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">Development Roadmap</h2>
                    <p class="text-lg text-gray-600">A phased approach from Minimum Viable Product to a full-featured service.</p>
                </header>
                
                <div class="w-full">
                    <div class="mb-6 border-b border-gray-200">
                        <nav class="-mb-px flex flex-wrap justify-center gap-2 md:gap-6" id="timeline-nav">
                            <button data-target="mvp" class="timeline-btn whitespace-nowrap py-3 px-4 text-sm md:text-base font-medium text-center text-gray-600 rounded-t-lg">🚀 MVP</button>
                            <button data-target="phase2" class="timeline-btn whitespace-nowrap py-3 px-4 text-sm md:text-base font-medium text-center text-gray-600 rounded-t-lg">Phase 2</button>
                            <button data-target="phase3" class="timeline-btn whitespace-nowrap py-3 px-4 text-sm md:text-base font-medium text-center text-gray-600 rounded-t-lg">Phase 3</button>
                            <button data-target="phase4" class="timeline-btn whitespace-nowrap py-3 px-4 text-sm md:text-base font-medium text-center text-gray-600 rounded-t-lg">Phase 4</button>
                        </nav>
                    </div>
                    <div id="timeline-content" class="p-4 md:p-6 bg-gray-50 rounded-lg min-h-[250px]">
                        <!-- Timeline content will be injected by JS -->
                    </div>
                </div>
            </div>
        </section>

        <section id="toolkit" class="content-section">
            <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                <header class="text-center mb-8">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">Developer Toolkit</h2>
                    <p class="text-lg text-gray-600">Guides for local setup, recommended tools, and deployment.</p>
                </header>

                <div class="mb-12">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">Local Development Setup</h3>
                     <p class="text-gray-600 mb-6">A well-configured local environment is crucial. This guide details setting up the monorepo, initializing the frontend and backend, and configuring VSCode for maximum productivity.</p>
                    <div id="setup-accordion" class="space-y-2">
                         <!-- Setup accordion items injected here by JS -->
                    </div>
                </div>
                
                <div class="mb-12">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">Core API Endpoints (v1)</h3>
                    <p class="text-gray-600 mb-6">This cheatsheet outlines the primary API endpoints that form the contract between the frontend and backend. All endpoints will be prefixed with `/api/v1`.</p>
                    <div class="overflow-x-auto">
                        <table class="min-w-full bg-white border">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="text-left font-semibold text-gray-600 p-3">Method</th>
                                    <th class="text-left font-semibold text-gray-600 p-3">Endpoint</th>
                                    <th class="text-left font-semibold text-gray-600 p-3">Module</th>
                                    <th class="text-left font-semibold text-gray-600 p-3">Description</th>
                                </tr>
                            </thead>
                            <tbody id="api-table-body" class="text-gray-700">
                                <!-- API endpoint rows injected here by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">Deployment Strategy</h3>
                    <p class="text-gray-600 mb-6">The deployment strategy is built on Docker for portability and consistency. This enables a flexible path from local development to scalable cloud platforms and even a self-hosted Raspberry Pi.</p>
                    <div class="grid md:grid-cols-3 gap-8 text-center">
                        <div class="flow-diagram-item bg-gray-50 p-6 rounded-lg border">
                            <h4 class="font-semibold text-lg mb-2">1. Containerize with Docker 🐳</h4>
                            <p class="text-gray-600 text-sm">Package the React frontend and FastAPI backend into portable, production-ready containers using multi-stage builds for lean and secure images.</p>
                        </div>
                        <div class="flow-diagram-item bg-gray-50 p-6 rounded-lg border">
                            <h4 class="font-semibold text-lg mb-2">2. Deploy to Cloud ☁️</h4>
                            <p class="text-gray-600 text-sm">Deploy the frontend to a global CDN like Vercel for speed. Deploy the backend container to a serverless platform like Google Cloud Run for auto-scaling.</p>
                        </div>
                        <div class="flow-diagram-item bg-gray-50 p-6 rounded-lg border">
                            <h4 class="font-semibold text-lg mb-2">3. Host on Raspberry Pi 🍓</h4>
                            <p class="text-gray-600 text-sm">Use `docker buildx` to create multi-architecture images. Pull and run the same container on a Raspberry Pi's ARM architecture for easy self-hosting.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="text-center p-8 mt-8 text-gray-500 text-sm">
        <p>Interactive Application Blueprint. Generated on <span id="generation-date"></span>.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const state = {
                frameworkData: {
                    labels: ['Performance', 'API-First Design', 'Type Safety', 'Ease for Decoupled SPA'],
                    datasets: [{
                        label: 'FastAPI',
                        data: [9, 9, 8, 9],
                        backgroundColor: 'rgba(56, 189, 12, 0.6)',
                        borderColor: 'rgba(56, 189, 12, 1)',
                        borderWidth: 1
                    }, {
                        label: 'Django',
                        data: [6, 5, 4, 5],
                        backgroundColor: 'rgba(59, 130, 246, 0.6)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 1
                    }]
                },
                schemaData: {
                    Users: [
                        { col: 'id', type: 'Integer', notes: 'Primary Key, Auto-increment' },
                        { col: 'email', type: 'String', notes: 'Not Null, Unique' },
                        { col: 'hashed_password', type: 'String', notes: 'Not Null' },
                        { col: 'full_name', type: 'String', notes: 'Not Null' },
                        { col: 'phone_number', type: 'String', notes: 'Nullable' },
                        { col: 'created_at', type: 'DateTime', notes: 'Not Null, Default NOW()' }
                    ],
                    Meals: [
                        { col: 'id', type: 'Integer', notes: 'Primary Key, Auto-increment' },
                        { col: 'name', type: 'String', notes: 'Not Null, Unique' },
                        { col: 'description', type: 'Text', notes: 'Not Null' },
                        { col: 'base_price', type: 'Decimal', notes: 'Not Null' },
                        { col: 'image_url', type: 'String', notes: 'Nullable' },
                        { col: 'is_available', type: 'Boolean', notes: 'Not Null, Default TRUE' }
                    ],
                    WeeklyMenus: [
                        { col: 'id', type: 'Integer', notes: 'Primary Key, Auto-increment' },
                        { col: 'week_start_date', type: 'Date', notes: 'Not Null, Unique' },
                        { col: 'title', type: 'String', notes: 'Not Null (e.g., "Menu for June 10-16")' },
                        { col: 'is_published', type: 'Boolean', notes: 'Not Null, Default FALSE' }
                    ],
                    WeeklyMenuMealLink: [
                        { col: 'weekly_menu_id', type: 'Integer', notes: 'Foreign Key (WeeklyMenus.id), Primary Key' },
                        { col: 'meal_id', type: 'Integer', notes: 'Foreign Key (Meals.id), Primary Key' }
                    ],
                    Orders: [
                        { col: 'id', type: 'Integer', notes: 'Primary Key, Auto-increment' },
                        { col: 'user_id', type: 'Integer', notes: 'Foreign Key (Users.id), Not Null' },
                        { col: 'order_date', type: 'DateTime', notes: 'Not Null, Default NOW()' },
                        { col: 'total_amount', type: 'Decimal', notes: 'Not Null' },
                        { col: 'status', type: 'String', notes: "Not Null (e.g., 'pending', 'delivered')" },
                        { col: 'delivery_address', type: 'Text', notes: 'Not Null' },
                        { col: 'delivery_date', type: 'Date', notes: 'Not Null' }
                    ],
                    OrderItems: [
                        { col: 'id', type: 'Integer', notes: 'Primary Key, Auto-increment' },
                        { col: 'order_id', type: 'Integer', notes: 'Foreign Key (Orders.id), Not Null' },
                        { col: 'meal_id', type: 'Integer', notes: 'Foreign Key (Meals.id), Not Null' },
                        { col: 'quantity', type: 'Integer', notes: 'Not Null' },
                        { col: 'price_at_purchase', type: 'Decimal', notes: 'Not Null' }
                    ],
                    Subscriptions: [
                        { col: 'id', type: 'Integer', notes: 'Primary Key, Auto-increment' },
                        { col: 'user_id', type: 'Integer', notes: 'Foreign Key (Users.id), Not Null, Unique' },
                        { col: 'plan_name', type: 'String', notes: 'Not Null' },
                        { col: 'status', type: 'String', notes: "Not Null (e.g., 'active', 'paused')" },
                        { col: 'start_date', type: 'Date', notes: 'Not Null' },
                        { col: 'next_billing_date', type: 'Date', notes: 'Nullable' }
                    ]
                },
                timelineData: {
                    mvp: {
                        title: '🚀 Minimum Viable Product (MVP)',
                        description: 'Launch with the most essential functionality to validate the core business concept: allowing customers to see and purchase meals.',
                        features: ['Secure User Registration & Login', 'Static Weekly Meal Viewing', 'One-Time Order Placement']
                    },
                    phase2: {
                        title: 'Phase 2: Subscription Service',
                        description: 'Introduce the core subscription functionality, including recurring billing and management.',
                        features: ['Create & Manage Subscriptions', 'Pause, Resume, Cancel Subscriptions', 'Integration with Payment Provider (e.g., Stripe)']
                    },
                    phase3: {
                        title: 'Phase 3: Advanced Customization',
                        description: 'Enhance the user experience with full profile management and advanced meal customization options.',
                        features: ['Full User Profile Management', 'Set Dietary Preferences', 'Save Default Meal Selections']
                    },
                    phase4: {
                        title: 'Phase 4: Administrative Features',
                        description: 'Develop a simple admin interface to manage the service, replacing the need for direct database access.',
                        features: ['CRUD for Meals', 'CRUD for Weekly Menus', 'User and Order Management Interface']
                    }
                },
                setupData: {
                    "Project Structure": {
                        type: 'code',
                        content: `meal_prep_project/\n├── backend/       # FastAPI App\n├── frontend/      # React App\n├── .vscode/\n├── .gitignore\n└── docker-compose.yml`
                    },
                    "Git & GitHub": {
                        type: 'steps',
                        content: [
                            'Initialize repository: `git init`',
                            'Create `.gitignore` file.',
                            'Link to remote: `git remote add origin <url>`',
                            'Initial commit and push.'
                        ]
                    },
                    "Backend Setup (FastAPI)": {
                        type: 'steps',
                        content: [
                            'Create and activate virtual environment: `python -m venv venv`',
                            'Install packages: `pip install "fastapi[all]" sqlmodel`',
                            'Freeze dependencies: `pip freeze > requirements.txt`',
                            'Create initial `app/main.py` file.'
                        ]
                    },
                    "Frontend Setup (React)": {
                        type: 'steps',
                        content: [
                            'Scaffold project with Vite: `npm create vite@latest . -- --template react-ts`',
                            'Install dependencies: `npm install`',
                            'Install HTTP client: `npm install axios`'
                        ]
                    }
                },
                apiData: [
                    { method: 'POST', endpoint: '/users/register', module: 'Users', description: 'Create a new user account.' },
                    { method: 'POST', endpoint: '/users/login', module: 'Users', description: 'Authenticate a user and receive a JWT.' },
                    { method: 'GET', endpoint: '/users/me', module: 'Users', description: 'Get current authenticated user\'s profile.' },
                    { method: 'GET', endpoint: '/menus/current', module: 'Meals', description: 'Fetch the published weekly menu.' },
                    { method: 'GET', endpoint: '/meals/{meal_id}', module: 'Meals', description: 'Get details for a specific meal.' },
                    { method: 'POST', endpoint: '/orders', module: 'Orders', description: 'Place a new one-time order.' },
                    { method: 'GET', endpoint: '/orders', module: 'Orders', description: 'List orders for the authenticated user.' },
                    { method: 'GET', endpoint: '/orders/{order_id}', module: 'Orders', description: 'Get details for a specific order.' }
                ]
            };

            const navLinks = document.querySelectorAll('.nav-link');
            const mobileNav = document.getElementById('mobile-nav');
            const sections = document.querySelectorAll('.content-section');
            const schemaAccordion = document.getElementById('schema-accordion');
            const setupAccordion = document.getElementById('setup-accordion');
            const apiTableBody = document.getElementById('api-table-body');
            const timelineNav = document.getElementById('timeline-nav');
            const timelineContent = document.getElementById('timeline-content');
            
            function navigateTo(hash) {
                if (!hash) hash = '#overview';
                
                sections.forEach(section => {
                    if ('#' + section.id === hash) {
                        section.classList.add('active');
                    } else {
                        section.classList.remove('active');
                    }
                });

                navLinks.forEach(link => {
                    if (link.getAttribute('href') === hash) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
                
                mobileNav.value = hash.substring(1);
                window.scrollTo(0, 0);
            }

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const hash = e.target.getAttribute('href');
                    navigateTo(hash);
                    window.location.hash = hash;
                });
            });

            mobileNav.addEventListener('change', (e) => {
                const hash = '#' + e.target.value;
                navigateTo(hash);
                window.location.hash = hash;
            });
            
            window.addEventListener('hashchange', () => navigateTo(window.location.hash));
            
            function createAccordionItem(title, content, parentElementId) {
                const sanitizedTitle = title.replace(/\s+/g, '-').replace(/[^a-zA-Z0-9-]/g, '');
                const id = `accordion-${parentElementId}-${sanitizedTitle}`;
                return `
                    <div class="border border-gray-200 rounded-lg">
                        <h2>
                            <button type="button" class="accordion-button flex items-center justify-between w-full p-4 font-medium text-left text-gray-700 bg-gray-50 hover:bg-gray-100 focus:outline-none" data-target="#${id}">
                                <span>${title}</span>
                                <span class="accordion-arrow transform transition-transform duration-300">▼</span>
                            </button>
                        </h2>
                        <div id="${id}" class="accordion-content bg-white">
                           ${content}
                        </div>
                    </div>
                `;
            }

            function createSchemaTable(data) {
                let rows = data.map(row => `
                    <tr>
                        <td class="p-3 border-t font-mono text-sm">${row.col}</td>
                        <td class="p-3 border-t text-sm">${row.type}</td>
                        <td class="p-3 border-t text-sm text-gray-600">${row.notes}</td>
                    </tr>
                `).join('');

                return `
                    <div class="overflow-x-auto p-4">
                        <table class="min-w-full">
                            <thead>
                                <tr>
                                    <th class="text-left p-3 font-semibold text-xs text-gray-500 uppercase tracking-wider">Column</th>
                                    <th class="text-left p-3 font-semibold text-xs text-gray-500 uppercase tracking-wider">Type</th>
                                    <th class="text-left p-3 font-semibold text-xs text-gray-500 uppercase tracking-wider">Notes</th>
                                </tr>
                            </thead>
                            <tbody>${rows}</tbody>
                        </table>
                    </div>
                `;
            }
            
            for (const [tableName, tableData] of Object.entries(state.schemaData)) {
                const tableHtml = createSchemaTable(tableData);
                schemaAccordion.innerHTML += createAccordionItem(tableName, tableHtml, 'schema');
            }

            for (const [title, data] of Object.entries(state.setupData)) {
                let contentHtml = '';
                if(data.type === 'code') {
                    contentHtml = `<div class="p-4"><pre class="bg-gray-800 text-white p-4 rounded-md text-sm">${data.content}</pre></div>`;
                } else if (data.type === 'steps') {
                    const stepsHtml = data.content.map(step => `<li class="flex items-start"><span class="mr-2 text-indigo-500 mt-1">▸</span><span>${step.replace(/`([^`]+)`/g, '<code class="bg-gray-200 text-red-600 font-mono text-xs p-1 rounded">\$&</code>').replace(/\$/g, '')}</span></li>`).join('');
                    contentHtml = `<div class="p-4"><ul class="space-y-2">${stepsHtml}</ul></div>`;
                }
                setupAccordion.innerHTML += createAccordionItem(title, contentHtml, 'setup');
            }
            
            document.querySelectorAll('.accordion-button').forEach(button => {
                button.addEventListener('click', () => {
                    const targetId = button.getAttribute('data-target');
                    const target = document.querySelector(targetId);
                    button.classList.toggle('open');
                    if (target.style.maxHeight) {
                        target.style.maxHeight = null;
                        target.style.padding = '0';
                    } else {
                        target.style.maxHeight = target.scrollHeight + "px";
                        target.style.padding = '0';
                    }
                });
            });
            
            apiTableBody.innerHTML = state.apiData.map(ep => {
                let methodColor = 'bg-gray-100 text-gray-800';
                if (ep.method === 'POST') methodColor = 'bg-blue-100 text-blue-800';
                if (ep.method === 'GET') methodColor = 'bg-green-100 text-green-800';
                return `
                    <tr class="border-t">
                        <td class="p-3"><span class="font-mono text-xs font-semibold px-2 py-1 rounded-md ${methodColor}">${ep.method}</span></td>
                        <td class="p-3 font-mono text-sm">${ep.endpoint}</td>
                        <td class="p-3">${ep.module}</td>
                        <td class="p-3 text-sm text-gray-600">${ep.description}</td>
                    </tr>
                `
            }).join('');
            
            function updateTimelineContent(targetId) {
                const data = state.timelineData[targetId];
                if (!data) return;
                
                timelineContent.innerHTML = `
                    <h4 class="text-xl font-bold text-gray-800 mb-2">${data.title}</h4>
                    <p class="text-gray-600 mb-4">${data.description}</p>
                    <ul class="space-y-2 list-inside">
                        ${data.features.map(f => `<li class="flex items-start"><span class="text-green-500 mr-2 mt-1">✓</span>${f}</li>`).join('')}
                    </ul>
                `;
                
                timelineNav.querySelectorAll('button').forEach(btn => {
                    if (btn.dataset.target === targetId) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
            }
            
            timelineNav.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    updateTimelineContent(e.target.dataset.target);
                }
            });
            
            new Chart(document.getElementById('frameworkChart'), {
                type: 'bar',
                data: state.frameworkData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, max: 10, grid: { color: 'rgba(0,0,0,0.05)' } },
                        x: { grid: { display: false } }
                    },
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: {
                            backgroundColor: '#fff',
                            titleColor: '#333',
                            bodyColor: '#666',
                            borderColor: '#ddd',
                            borderWidth: 1,
                        }
                    }
                }
            });

            const moduleItems = document.querySelectorAll('.module-diagram-item');
            moduleItems.forEach(item => {
                item.addEventListener('click', () => {
                    moduleItems.forEach(i => i.style.transform = 'scale(1)');
                    item.style.transform = 'scale(1.1)';
                })
            });

            document.getElementById('generation-date').textContent = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });

            navigateTo(window.location.hash || '#overview');
            updateTimelineContent('mvp');
        });
    </script>
</body>
</html>
